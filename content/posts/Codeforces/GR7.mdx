---
slug: /competitive-programming/CF-Global7
title: Codeforces Global Round 7
date: 2020-07-16

keywords:
  - CF
  - 
---

## D. Prefix-Suffix Palindrome

[問題](https://codeforces.com/contest/1326/problem/D2)

文字列$S$の前から$a$文字、後ろから$b$文字取って最長の回文を作る問題。

まず愚直に解いてみる。

前から$i$文字、後ろから$j$文字取る取り方を全探索して回文かどうか判定しようとすると、$O(|S|^3)$で解くことができる。

### Easy Version

Easyの制約は、$|S| \leq 5000$なので、$O(|S|^2)$に計算量を落としたい。

そこで回文の性質に注目してみる。

回文は前後から同じ文字数だけ取っても回文である。

つまり、

回文 = (文字列$X$) + (回文) + reverse(文字列$X$)

という条件が成り立っている。

したがって、$S$の前後が同じ文字である限り取り出し、残った文字列$S'$の先頭あるいは末尾から連続する最長の回文を求めればよい。

先頭から連続する最長の回文は、$S'$を走査しながら回文判定をすればよいので$O(|S|^2)$で解くことが出来た。

### Hard Version

Hardの制約は、$|S| \leq 10^6$なので、線形のアルゴリズムが求められている。

文字列$S'$から最長の回文を取り出すアルゴリズムがあればよさそうである。

これは最長回文問題として知られ、```Manacher’s algorithm```によって$O(|S|)$
で解くことができる。

```Manacher’s algorithm```では、$i$番目の文字を中心とした回文の最大半径を求めることができる。

今回の問題では、${\rm radius}(S'_i) == i$となる最大の$i$を求めればよい。

